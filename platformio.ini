; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: custom upload port, speed and extra flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html

[env:nodemcu-32s]
platform = espressif32
board = nodemcu-32s
framework = arduino
upload_speed = 921600
monitor_speed = 115200
lib_deps = 
	bblanchon/ArduinoJson@^7.0.0
    finianlandes/SpotifyEsp32@^3.0.0
    https://github.com/adafruit/Adafruit-GFX-Library.git
    https://github.com/adafruit/Adafruit-ST7735-Library.git
    https://github.com/Bodmer/TFT_eSPI.git
    https://github.com/lvgl/lvgl.git
    madhephaestus/ESP32Encoder@^0.12.0

board_build.partitions = huge_app.csv

# Memory optimization flags
build_flags = 
    # Size optimization (critical for large apps)
    -Os
    
    # Disable debug logging (saves ~20-30KB)
    -DCORE_DEBUG_LEVEL=0
    
    # PSRAM support (set to 1 if you have WROVER module)
    -DBOARD_HAS_PSRAM=0
    
    # LVGL memory optimization
    -DLVGL_OPTIMIZE_SIZE=1
    
    # Increase frequency for performance (optional)
    -DCONFIG_ESP32_DEFAULT_CPU_FREQ_MHZ=240

    # disable bluetooth to save memory
    -DCONFIG_BT_ENABLED=0
    -DCONFIG_BLE_ENABLED=0
    -DCONFIG_BLUEDROID_ENABLED=0
    
    # Compiler optimizations to reduce code size
    -ffunction-sections
    -fdata-sections
    -Wl,--gc-sections
    
    # Remove unused code
    -Wl,--strip-all



